<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/styleConfig.css">
    <link rel="icon" href="imagens/logo-icon.png" type="image/x-icon">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <title>Configuração - NutriWeb</title>
</head>
<body>
    <header class="header">
        <section class="left-section">
            <a href="/"><img src="imagens/logo.png" alt="Logo" class="logo"></a>
            <a href="/ranking" class="ranking"><button class="ranking-button">Ranking</button></a>
            <a href="/profissionais"><button class="profissionais-button">Profissionais</button></a>
        </section>
    
        <section class="center-section">
            <section class="input-premium">
                <span class="material-icons search-icon md-24">search</span>
                <input>
            </section>
        </section>
        
        <section class="right-section">
            <% if (headerUsuario.estaLogado) { %>
                <a href="/premium"><button class="premium-button">Premium</button></a>
                
                <a href="<%= headerUsuario.urlPerfil %>" class="perfil-usuario-link">
                    <div class="perfil-usuario">
                        <img src="<%= headerUsuario.fotoPerfil %>" 
                             alt="Foto de perfil" 
                             class="foto-perfil-header"
                             onerror="this.src='imagens/foto_perfil.jpg'">
                        <span class="nome-usuario-header"><%= headerUsuario.nome %></span>
                    </div>
                </a>
            <% } else { %>
                <a href="/premium"><button class="premium-button">Premium</button></a>
                <a href="/login"><button class="entrar-button">Entrar</button></a>
            <% } %>
        </section>
    </header>
    
    <section class="header-content">
        <a href="/perfilnutri" class="back-button">
            <span class="material-icons arrow-icon md-24">arrow_back_ios</span>
            <span class="back-arrow">Voltar</span>
        </a>
    </section>

    <main>

        <%
        let erroValidacao = {
            "nome": "", 
            "telefone": "", 
            "ddd": "",
            "email": "", 
            "senha": "", 
            "area": "", 
            "crn": ""
        };
        let msgErro = {
            "nome": "", 
            "telefone": "", 
            "ddd": "",
            "email": "", 
            "senha": "", 
            "area": "", 
            "crn": ""
        };
        
        if(listaErros) {
            listaErros.errors.forEach(function(erro) {
                if (erro.path == "nome") {
                    erroValidacao.nome = "erro-form";
                    msgErro.nome = erro.msg;
                }
                if (erro.path == "telefone") {
                    erroValidacao.telefone = "erro-form";
                    msgErro.telefone = erro.msg;
                }
                if (erro.path == "ddd") {
                    erroValidacao.ddd = "erro-form";
                    msgErro.ddd = erro.msg;
                }
                if (erro.path == "email") {
                    erroValidacao.email = "erro-form";
                    msgErro.email = erro.msg;
                }
                if (erro.path == "senha") {
                    erroValidacao.senha = "erro-form";
                    msgErro.senha = erro.msg;
                }
                if (erro.path == "area") {
                    erroValidacao.area = "erro-form";
                    msgErro.area = erro.msg;
                }
                if (erro.path == "crn") {
                    erroValidacao.crn = "erro-form";
                    msgErro.crn = erro.msg;
                }
            });
        }
        %>

        <section class="conteudo">
            <section class="left-panel">
                <h1>Configurações</h1>
                <nav>
                    <ul>
                        <li id="menu-imagens" class="active">Foto de Perfil e Banner</li>
                        <li id="menu-dados">Dados Pessoais</li>
                        <li id="menu-links">Links</li>
                        <li id="menu-suporte">Suporte</li>
                    </ul>
                </nav>
            </section>
            <section class="right-panel">
                <section id="secao-imagens" class="config-section ativo">
                    <h1>Foto de Perfil e Banner</h1>
                    <form id="form-imagens" action="/atualizar-imagens" method="POST" enctype="multipart/form-data">
                        <section class="container-imagens">
                            <section class="container-fotoPerfil">
                                <section class="image-preview-container">
                                    <img src="<%= headerUsuario.fotoPerfil %>"
                                         id="preview-perfil"
                                         class="foto-perfil"
                                         onerror="this.src='/imagens/foto_perfil.jpg'">
                                    <section class="overlay ovl-fotoperfil">
                                        <label for="input-foto-perfil" class="btn-upload">
                                            <i class="fas fa-camera"></i>
                                            Alterar Foto
                                        </label>
                                    </section>
                                </section>
                                <input type="file" 
                                       id="input-foto-perfil" 
                                       name="fotoPerfil" 
                                       accept="image/jpeg,image/jpg,image/png,image/gif,image/webp"
                                       style="display: none;">
                                <h2>Foto de Perfil</h2>
                                <p class="image-info">Formatos aceitos: JPEG, PNG, GIF, WEBP<br>Tamanho máximo: 5MB</p>
                            </section>
                            
                            <section class="container-fotoBanner">
                                <div class="image-preview-container">
                                    <img src="<%= headerUsuario.fotoBanner %>"
                                         id="preview-banner"
                                         class="foto-banner"
                                         onerror="this.src='/imagens/foto_perfil.jpg'">
                                    <div class="overlay">
                                        <label for="input-foto-banner" class="btn-upload">
                                            <i class="fas fa-camera"></i>
                                            Alterar Banner
                                        </label>
                                    </div>
                                </div>
                                <input type="file" 
                                       id="input-foto-banner" 
                                       name="fotoBanner" 
                                       accept="image/jpeg,image/jpg,image/png,image/gif,image/webp"
                                       style="display: none;">
                                <h2>Banner</h2>
                                <p class="image-info">Formatos aceitos: JPEG, PNG, GIF, WEBP<br>Tamanho máximo: 5MB</p>
                            </section>
                        </section>
                        
                        <section class="container-botoes">
                            <button type="button" class="botao cancel">Cancelar</button>
                            <button type="submit" class="botao save">Salvar</button>
                        </section>
                    </form>
                </section>

                <section id="secao-dados" class="config-section">
                    <h1>Dados Pessoais</h1>
                    <form id="form-dados" action="/atualizar-dados" method="POST">
                        
                        <section class="campo-form">
                            <label for="nome">Nome Completo</label>
                            <% if (msgErro.nome) { %>
                                <span class="erro-mensagem"><%= msgErro.nome %></span>
                            <% } %>
                            <input type="text" 
                                id="nome" 
                                name="nome" 
                                value="<%= valores && valores.nome ? valores.nome : (headerUsuario.dadosCompletos ? headerUsuario.dadosCompletos.nome : '') %>" 
                                class="<%= erroValidacao.nome %>" 
                                placeholder="Nome Completo"
                                maxlength="125"
                                oninput="this.value = this.value.replace(/[^a-zA-ZÀ-ÿ\s]/g, '')">
                        </section>
                        
                        <section class="campo-form">
                            <label for="sobreMim">Sobre você</label>
                            <textarea name="sobreMim"
                            id="sobreMim" 
                            placeholder="Ex: Sou Roberta Santos, nutricionista especializada em nutrição esportiva. Meu objetivo é ajudar na alimentação para potencializar resultados e promover saúde. Cada atleta é único, e estou aqui para traçar uma jornada nutricional que faz a diferença no seu treino e na sua vida!" 
                            class="campo-texto" 
                            maxlength="400"><%= valores && valores.sobreMim ? valores.sobreMim : (headerUsuario.dadosCompletos ? headerUsuario.dadosCompletos.sobreMim : '') %></textarea>
                        </section>
                        
                        <section class="campo-form">
                            <label for="email">E-mail</label>
                            <% if (msgErro.email) { %>
                                <span class="erro-mensagem"><%= msgErro.email %></span>
                            <% } %>
                            <input type="text" 
                                id="email" 
                                name="email" 
                                value="<%= valores && valores.email ? valores.email : (headerUsuario.dadosCompletos ? headerUsuario.dadosCompletos.email : '') %>" 
                                class="<%= erroValidacao.email %>" 
                                placeholder="E-mail"
                                maxlength="50">
                        </section>
                        
                        <section class="container-tel-senha">
                            <section class="campo-form campo-senha">
                                <label for="senha">Senha</label>
                                <% if (msgErro.senha) { %>
                                    <span class="erro-mensagem"><%= msgErro.senha %></span>
                                <% } %>
                                <input type="password" 
                                    id="senha" 
                                    name="senha" 
                                    value="<%= valores && valores.senha ? valores.senha : '' %>" 
                                    class="<%= erroValidacao.senha %>"
                                    placeholder="Crie uma senha"
                                    maxlength="25">
                                <section id="password-requirements">
                                    <span>A senha deve conter:</span>
                                    <ul>
                                        <li id="length" class="invalid">Pelo menos 8 caracteres</li>
                                        <li id="uppercase" class="invalid">Pelo menos uma letra maiúscula</li>
                                        <li id="lowercase" class="invalid">Pelo menos uma letra minúscula</li>
                                        <li id="number" class="invalid">Pelo menos um número</li>
                                        <li id="special" class="invalid">Pelo menos um caractere especial</li>
                                    </ul>
                                </section>
                            </section>
                            
                            <section class="campo-form">
                                <label for="telefone">Telefone:</label>
                                <section class="campo-telefone-container">
                                    <section class="campo-ddd">
                                        <label for="ddd">DDD:</label>
                                        <input type="text" 
                                            id="ddd" 
                                            name="ddd" 
                                            value="<%= valores && valores.ddd ? valores.ddd : (headerUsuario.dadosCompletos ? headerUsuario.dadosCompletos.ddd : '') %>"
                                            class="<%= erroValidacao.ddd %>" 
                                            maxlength="2"
                                            pattern="[0-9]{2}"
                                            oninput="this.value = this.value.replace(/[^0-9]/g, '')">
                                    </section>
                                    <section class="campo-telefone">
                                        <input type="text" 
                                            id="telefone-numero" 
                                            name="telefone" 
                                            value="<%= valores && valores.telefone ? valores.telefone : (headerUsuario.dadosCompletos ? headerUsuario.dadosCompletos.telefone : '') %>" 
                                            class="<%= erroValidacao.telefone %>" 
                                            maxlength="9"
                                            pattern="[0-9]{8,9}"
                                            oninput="this.value = this.value.replace(/[^0-9]/g, '')">
                                    </section>
                                </section>
                                <% if (msgErro.ddd) { %>
                                    <span class="erro-mensagem"><%= msgErro.ddd %></span>
                                <% } %>
                                <% if (msgErro.telefone) { %>
                                    <span class="erro-mensagem"><%= msgErro.telefone %></span>
                                <% } %>
                            </section>
                        </section>
                        
                        <% if (headerUsuario.tipo == 'N') { %>
                            <section class="campo-form">
                                <label for="crn">CRN</label>
                                <% if (msgErro.crn) { %>
                                    <span class="erro-mensagem"><%= msgErro.crn %></span>
                                <% } %>
                                <input type="text" 
                                    id="crn" 
                                    name="crn"
                                    value="<%= valores && valores.crn ? valores.crn : (headerUsuario.dadosCompletos ? headerUsuario.dadosCompletos.crn : '') %>" 
                                    class="<%= erroValidacao.crn %>" 
                                    placeholder="Número de CRN" 
                                    maxlength="11"
                                    oninput="this.value = this.value.replace(/[^0-9]/g, '')">
                            </section>
                        <% } %>

                        <% if (headerUsuario.tipo == 'N') { %>
                            <section class="campo-form" id="campo-form-checkbox">
                                <h1>Especialidade</h1>
                                <label for="area">Em qual área da nutrição você se sente mais familiarizado:</label>
                                    
                                <section class="checkbox-group-container">
                                    <section class="checkbox-group">
                                        <input type="checkbox" 
                                                name="area" 
                                                id="esportiva" 
                                                value="Esportiva"
                                                <%= (valores && valores.area && (Array.isArray(valores.area) ? valores.area.includes('Esportiva') : valores.area === 'Esportiva')) || (headerUsuario.dadosCompletos && headerUsuario.dadosCompletos.area && headerUsuario.dadosCompletos.area.includes('Esportiva')) ? 'checked' : '' %>>
                                        <label for="esportiva">Nutrição Esportiva</label>
                                    </section>
                                        
                                    <section class="checkbox-group">
                                        <input type="checkbox" 
                                                name="area" 
                                                id="estetica" 
                                                value="Estética"
                                                <%= (valores && valores.area && (Array.isArray(valores.area) ? valores.area.includes('Estética') : valores.area === 'Estética')) || (headerUsuario.dadosCompletos && headerUsuario.dadosCompletos.area && headerUsuario.dadosCompletos.area.includes('Estética')) ? 'checked' : '' %>>
                                        <label for="estetica">Nutrição Estética</label>
                                    </section>
                                        
                                    <section class="checkbox-group">
                                        <input type="checkbox" 
                                                name="area" 
                                                id="clinica" 
                                                value="Clínica"
                                                <%= (valores && valores.area && (Array.isArray(valores.area) ? valores.area.includes('Clínica') : valores.area === 'Clínica')) || (headerUsuario.dadosCompletos && headerUsuario.dadosCompletos.area && headerUsuario.dadosCompletos.area.includes('Clínica')) ? 'checked' : '' %>>
                                        <label for="clinica">Nutrição Clínica</label>
                                    </section>
                                        
                                    <section class="checkbox-group">
                                        <input type="checkbox" 
                                                name="area" 
                                                id="vegetariana" 
                                                value="Vegetariana"
                                                <%= (valores && valores.area && (Array.isArray(valores.area) ? valores.area.includes('Vegetariana') : valores.area === 'Vegetariana')) || (headerUsuario.dadosCompletos && headerUsuario.dadosCompletos.area && headerUsuario.dadosCompletos.area.includes('Vegetariana')) ? 'checked' : '' %>>
                                        <label for="vegetariana">Nutrição Vegetariana</label>
                                    </section>
                                    
                                    <section class="checkbox-group">
                                        <input type="checkbox" 
                                                name="area" 
                                                id="maternoinfantil" 
                                                value="Materno-Infantil"
                                                <%= (valores && valores.area && (Array.isArray(valores.area) ? valores.area.includes('Materno-Infantil') : valores.area === 'Materno-Infantil')) || (headerUsuario.dadosCompletos && headerUsuario.dadosCompletos.area && headerUsuario.dadosCompletos.area.includes('Materno-Infantil')) ? 'checked' : '' %>>
                                        <label for="maternoinfantil">Nutrição Materno-Infantil</label>
                                    </section>
                                    
                                    <section class="checkbox-group">
                                        <input type="checkbox" 
                                                name="area" 
                                                id="geriatrica" 
                                                value="Geriátria"
                                                <%= (valores && valores.area && (Array.isArray(valores.area) ? valores.area.includes('Geriátrica') : valores.area === 'Geriátrica')) || (headerUsuario.dadosCompletos && headerUsuario.dadosCompletos.area && headerUsuario.dadosCompletos.area.includes('Geriátrica')) ? 'checked' : '' %>>
                                        <label for="geriatrica">Nutrição Geriátrica</label>
                                    </section>
                                    
                                    <section class="checkbox-group">
                                        <input type="checkbox" 
                                                name="area" 
                                                id="preventiva" 
                                                value="Preventiva"
                                                <%= (valores && valores.area && (Array.isArray(valores.area) ? valores.area.includes('Preventiva') : valores.area === 'Preventiva')) || (headerUsuario.dadosCompletos && headerUsuario.dadosCompletos.area && headerUsuario.dadosCompletos.area.includes('Preventiva')) ? 'checked' : '' %>>
                                        <label for="preventiva">Nutrição Preventiva</label>
                                    </section>
                                    
                                    <section class="checkbox-group">
                                        <input type="checkbox" 
                                                name="area" 
                                                id="balanceada" 
                                                value="Balanceada"
                                                <%= (valores && valores.area && (Array.isArray(valores.area) ? valores.area.includes('Balanceada') : valores.area === 'Balanceada')) || (headerUsuario.dadosCompletos && headerUsuario.dadosCompletos.area && headerUsuario.dadosCompletos.area.includes('Balanceada')) ? 'checked' : '' %>>
                                        <label for="balanceada">Nutrição Balanceada</label>
                                    </section>
                                    
                                    <section class="checkbox-group">
                                        <input type="checkbox" 
                                                name="area" 
                                                id="funcional" 
                                                value="Funcional"
                                                <%= (valores && valores.area && (Array.isArray(valores.area) ? valores.area.includes('Funcional') : valores.area === 'Funcional')) || (headerUsuario.dadosCompletos && headerUsuario.dadosCompletos.area && headerUsuario.dadosCompletos.area.includes('Funcional')) ? 'checked' : '' %>>
                                        <label for="funcional">Nutrição Funcional</label>
                                    </section>
                                </section>
                                <% if (msgErro.area) { %>
                                    <span class="erro-mensagem"><%= msgErro.area %></span>
                                <% } %>
                            </section>
                        <% } %>
                        <section class="container-botoes">
                            <button type="button" class="botao cancel">Cancelar</button>
                            <button type="submit" class="botao save">Salvar</button>
                        </section>
                    </form>
                </section>
            
                <section id="secao-links" class="config-section">
                    <h1>Links</h1>
                </section>
                
                <section id="secao-suporte" class="config-section">
                    <h1>Suporte</h1>
                </section>
                
            </section>
        </section>
    </main>

    <section class="mobile">
        <section class="menu">
            <section class="left-section">
                <a href="/"><img src="imagens/logo.png" alt="Logo" class="logo"></a>
            </section>

            <section class="right-section">
                <span class="material-icons search-icon md-24 menu-icon">menu</span>
            </section>
        </section>

        <section class="mobile-menu hidden">
            <ul>
                <li><a href="/perfilcliente">Meu Perfil</a></li>
                <li><a href="/ranking">Ranking</a></li>
                <li><a href="/profissionais">Profissionais</a></li>
                <li><a href="/premium">Premium</a></li>
                <li><a href="/login">Entrar</a></li>
            </ul>
        </section>
    </section>

    <footer>
        <section class="footer-container">
            <section class="footer-logo">
                <a href="/"><img src="imagens/logo.png" alt="Logo" class="logo"></a>
                <a href="/"><h3>NutriWeb</h3></a>
            </section>

            <section class="footer-informacao">
                <a href="/">Página Inicial</a>
                <a href="/ranking">Ranking</a>
                <a href="/profissionais">Profissionais</a>
                <a href="/premium">Premium</a>
                <a href="/login">Login</a>
                <a href="/">Sobre nós</a> 
                <a href="/tipoNutri">Como escolher o profissional ideal?</a>
            </section>

          <section class="footer-social">
              <p>Conecte-se com os melhores nutricionistas e encontre o profissional ideal para você.</p>
            <h3>Siga-nos</h3>
                <section class="social-icons">
                <a href="https://www.instagram.com/nutriweb_oficial/"><i class="fab fa-instagram"></i></a>
                </section>
          </section>
        </section>
        
        <section class="footer-bottom">
          <p>&copy; 2024 NutriWeb. Todos os direitos reservados.</p>
        </section>
    </footer>

    <script src="js/config.js"></script>
    <script src="js/validacaotemporeal.js"></script>
    <script src="js/alerts.js"></script>
</body>
</html>