<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhes do Usuário - Painel Administrativo</title>
    <link rel="stylesheet" href="/css/styleAdm.css">
    <link rel="stylesheet" href="/css/admin-detalhes.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
</head>
<body>
    <section class="navbar navbar-inverse">
        <section class="navbar-header">
            <ul class="nav navbar-nav">
                <li><a href="/adm">Dashboard</a></li>
                <li class="active"><a href="/adm/usuarios">Usuários</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="/">Voltar ao Site</a></li>
            </ul>
        </section>
    </section>

    <section class="container">
        <section class="page-header">
            <h2>
                <section class="material-symbols-outlined">person</section>
                Detalhes do Usuário
            </h2>
            <p class="page-subtitle">Informações completas do usuário cadastrado</p>
        </section>

        <% if (usuario) { %>
            <section class="user-details-card">
                <section class="card-header">
                    <section class="user-avatar">
                        <% if (usuario.FotoPerfil) { %>
                            <img src="/adm/imagem/perfil/<%= usuario.id %>?t=<%= timestamp %>" 
                                 alt="Avatar de <%= usuario.NomeCompleto %>" 
                                 class="avatar-img"
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';">
                            <section class="material-symbols-outlined" style="display:none;">account_circle</section>
                        <% } else { %>
                            <section class="material-symbols-outlined">account_circle</section>
                        <% } %>
                    </section>
                    <section class="user-header-info">
                        <h3><%= usuario.NomeCompleto %></h3>
                        <p class="user-type">
                            <section class="badge badge-<%= usuario.UsuarioTipo === 'N' ? 'success' : (usuario.UsuarioTipo === 'A' ? 'admin' : 'info') %>">
                                <%= usuario.TipoUsuarioNome %>
                            </section>
                            <section class="status-badge status-<%= usuario.UsuarioStatus === 1 ? 'ativo' : 'inativo' %>">
                                <%= usuario.StatusNome %>
                            </section>
                        </p>
                    </section>
                </section>

                <section class="card-body">
                    <section class="info-section">
                        <h4>
                            <section class="material-symbols-outlined">badge</section>
                            Informações Básicas
                        </h4>
                        <section class="info-list">
                            <section class="info-item">
                                <dt>ID do Usuário</dt>
                                <dd><section class="info-value">#<%= usuario.id %></section></dd>
                            </section>
                            <section class="info-item">
                                <dt>Nome Completo</dt>
                                <dd><%= usuario.NomeCompleto %></dd>
                            </section>
                            <section class="info-item">
                                <dt>Email</dt>
                                <dd><%= usuario.Email %></dd>
                            </section>
                            <section class="info-item">
                                <dt>Telefone</dt>
                                <dd>
                                    <%= usuario.Telefone ?
                                        `(${usuario.Telefone.substring(0,2)}) ${usuario.Telefone.substring(2,7)}-${usuario.Telefone.substring(7)}`
                                        : 'Não informado' %>
                                </dd>
                            </section>
                            <section class="info-item">
                                <dt>Data de Nascimento</dt>
                                <dd>
                                    <%= usuario.DataNascimento ? 
                                        new Date(usuario.DataNascimento).toLocaleDateString('pt-BR') 
                                        : 'Não informado' %>
                                </dd>
                            </section>
                            <section class="info-item">
                                <dt>Tipo de Usuário</dt>
                                <dd><%= usuario.TipoUsuarioNome %></dd>
                            </section>
                            <section class="info-item">
                                <dt>Status</dt>
                                <dd>
                                    <section class="status-label status-<%= usuario.UsuarioStatus === 1 ? 'ativo' : 'inativo' %>">
                                        <%= usuario.StatusNome %>
                                    </section>
                                </dd>
                            </section>
                        </section>
                    </section>

                    <section class="info-section">
                        <h4>
                            <section class="material-symbols-outlined">location_on</section>
                            Endereço
                        </h4>
                        <section class="info-list">
                            <section class="info-item">
                                <dt>CEP</dt>
                                <dd>
                                    <%= usuario.CEP ? usuario.CEP : 'Não informado' %>
                                </dd>
                            </section>
                        </section>
                    </section>

                    <% if (usuario.UsuarioTipo === 'N') { %>
                        <section class="info-section">
                            <h4>
                                <section class="material-symbols-outlined">medical_services</section>
                                Informações Profissionais (Nutricionista)
                            </h4>
                            <section class="info-list">
                                <section class="info-item">
                                    <dt>CRN (Conselho Regional)</dt>
                                    <dd>
                                        <%= usuario.Crn ? usuario.Crn : 'Não informado' %>
                                    </dd>
                                </section>
                                <section class="info-item">
                                    <dt>Razão Social</dt>
                                    <dd>
                                        <%= usuario.RazaoSocial ? usuario.RazaoSocial : 'Não informado' %>
                                    </dd>
                                </section>
                            </section>
                        </section>
                    <% } %>

                    <% if (usuario.UsuarioTipo === 'C') { %>
                        <section class="info-section">
                            <h4>
                                <section class="material-symbols-outlined">fingerprint</section>
                                Documentação (Cliente)
                            </h4>
                            <section class="info-list">
                                <section class="info-item">
                                    <dt>CPF</dt>
                                    <dd>
                                        <% if (usuario.CPF) { %>
                                            <%= usuario.CPF %>
                                        <% } else { %>
                                            <section class="not-informed">Não informado</section>
                                        <% } %>
                                    </dd>
                                </section>
                            </section>
                        </section>
                    <% } %>

                </section>

                <section class="card-footer">
                    <a href="/adm/usuarios-editar?id=<%= usuario.id %>" class="btn btn-warning">
                        <section class="material-symbols-outlined">edit</section>
                        Editar Usuário
                    </a>
                    <a href="/adm/usuarios-excluir?id=<%= usuario.id %>" class="btn btn-danger">
                        <section class="material-symbols-outlined">delete</section>
                        Inativar Usuário
                    </a>
                    <a href="/adm/usuarios" class="btn btn-default">
                        <section class="material-symbols-outlined">arrow_back</section>
                        Voltar para Lista
                    </a>
                </section>
            </section>
        <% } else { %>
            <section class="alert alert-danger">
                <strong>Erro!</strong> Usuário não encontrado.
            </section>
            <a href="/adm/usuarios" class="btn btn-primary">
                <section class="material-symbols-outlined">arrow_back</section>
                Voltar para Lista
            </a>
        <% } %>

        <hr />
        <footer>
            <p>&copy; 2025 Sistema NutriWeb | Painel Administrativo</p>
        </footer>
    </section>
</body>
</html>